(window.webpackJsonp=window.webpackJsonp||[]).push([[106],{1237:function(t,e,n){"use strict";n.r(e);var r=n(116),o=n(133),c=n(999),l=n(1220),d=n(115),v=n(510),f=n(860),_=n(846),m=n(348),h=n(218),y=n(95),k=n(850),x=n(829),w=(n(35),n(3)),O=n(40);n(108),n(33),n(269),n(36),n(219),n(220),n(6),n(79),n(63),n(14),n(13),n(12),n(17),n(11),n(18);function D(object,t){var e=Object.keys(object);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(object);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),e.push.apply(e,n)}return e}function F(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?D(Object(source),!0).forEach((function(e){Object(w.a)(t,e,source[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):D(Object(source)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(source,e))}))}return t}var C={data:function(){return{showFilters:!1,filters:{},isFilter:!1,totalRowsCount:0,datatable_search_textbox:"",filter_employeeid:"",snack:!1,snackColor:"",snackText:"",Model:"Device",pagination:{current:1,total:0,per_page:100},options:{},endpoint:"device",search:"",snackbar:!1,dialog:!1,data:[],loading:!1,total:0,headers_table:[{text:"Name",align:"left",sortable:!0,value:"name",filterable:!0},{text:"Short Name",align:"left",sortable:!0,value:"short_name",filterable:!0},{text:"Location",align:"left",sortable:!0,value:"location",filterable:!0},{text:"Device Id",align:"left",sortable:!0,value:"device_id",filterable:!0},{text:"Type",align:"left",sortable:!0,value:"device_type",filterable:!0},{text:"Status",align:"center",sortable:!0,value:"status_id",filterable:!0,filterSpecial:!0},{text:"Door",align:"center",sortable:!1,value:"status",filterable:!1},{text:"Time Sync",align:"left",sortable:!0,value:"sync_date_time",filterable:!1}],editedIndex:-1,response:"",errors:[]}},computed:{formTitle:function(){return-1===this.editedIndex?"New device":"Edit device"}},watch:{options:{handler:function(){this.getDataFromApi()},deep:!0},dialog:function(t){t||this.close(),this.errors=[],this.search=""}},created:function(){this.loading=!0,this.getDataFromApi()},methods:{datatable_save:function(){},datatable_cancel:function(){this.datatable_search_textbox=""},datatable_open:function(){this.datatable_search_textbox=""},datatable_close:function(){this.loading=!1},sync_date_time:function(t){var e=this,dt=new Date,n=dt.getFullYear(),r=dt.getMonth()+1,o=dt.getDate(),c=dt.getHours();c=c<10?"0"+c:c;var l=dt.getMinutes();l=l<10?"0"+l:l;var d=dt.getSeconds();d=d<10?"0"+d:d;var v={params:{sync_able_date_time:"".concat(n,"-").concat(r,"-").concat(o," ").concat(c,":").concat(l,":").concat(d)}};this.$axios.get("sync_device_date_time/".concat(t.device_id),v).then((function(n){var data=n.data;if(data.status){var r=e.data.findIndex((function(e){return e.id==t.id}));e.data.splice(r,1,data.record)}e.snackbar=!0,e.response=data.message}))},open_door:function(t){var e=this,n={params:{device_id:t}};this.$axios.get("open_door",n).then((function(t){var data=t.data;e.snackbar=!0,e.response=data}))},open_door_always:function(t){var e=this,n={params:{device_id:t}};this.$axios.get("open_door_always",n).then((function(t){var data=t.data;e.snackbar=!0,e.response=data.message,e.getDataFromApi()}))},close_door:function(t){var e=this,n={params:{device_id:t}};this.$axios.get("close_door",n).then((function(t){var data=t.data;e.snackbar=!0,e.response=data.message,e.getDataFromApi()}))},can:function(t){this.$auth},caps:function(t){return""==t||null==t?"---":t.toString().replace(/\b\w/g,(function(t){return t.toUpperCase()}))},onPageChange:function(){this.getDataFromApi()},applyFilters:function(){this.getDataFromApi()},toggleFilter:function(){this.isFilter=!this.isFilter},clearFilters:function(){this.filters={},this.isFilter=!1,this.getDataFromApi()},getDataFromApi:function(){var t=arguments,e=this;return Object(O.a)(regeneratorRuntime.mark((function n(){var r,o,c,l,d,v,f,_,m,h,y;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.length>0&&void 0!==t[0]?t[0]:e.endpoint,o=t.length>1&&void 0!==t[1]?t[1]:"",c=t.length>2&&void 0!==t[2]?t[2]:"",""==r&&(r=e.endpoint),e.loading=!0,l=e.options,d=l.sortBy,v=l.sortDesc,f=l.page,_=l.itemsPerPage,m=d?d[0]:"",h=v?v[0]:"",y={params:F({page:f,sortBy:m,sortDesc:h,per_page:_,company_id:e.$auth.user.company_id},e.filters)},""!=o&&(y.params[o]="serach_status_name"==o?"online"==c.toLowerCase()?"active":"offline"==c.toLowerCase()?"inactive":"":c),n.next=12,e.$axios.get("".concat(r,"?page=").concat(f),y).then((function(t){var data=t.data;if(""!=o&&0==data.data.length)return e.snack=!0,e.snackColor="error",e.snackText="No Results Found",e.loading=!1,!1;e.totalRowsCount=data.total,e.data=data.data,e.pagination.current=data.current_page,e.pagination.total=data.last_page,e.loading=!1}));case 12:case"end":return n.stop()}}),n)})))()},updateDevicesHealth:function(){var t=this;return Object(O.a)(regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={params:{company_id:t.$auth.user.company_id}},e.next=3,t.$axios.get("/check_device_health",n).then((function(e){var data=e.data;t.snackbar=!0,t.response=data,t.getDataFromApi()}));case 3:case"end":return e.stop()}}),e)})))()},searchIt:function(t){0==t.length?this.getDataFromApi():t.length>2&&this.getDataFromApi("".concat(this.endpoint,"/search/").concat(t))}}},S=C,j=n(61),component=Object(j.a)(S,(function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"text-center ma-2"},[e(_.a,{attrs:{top:"top",color:"secondary",elevation:"24"},model:{value:t.snackbar,callback:function(e){t.snackbar=e},expression:"snackbar"}},[t._v("\n      "+t._s(t.response)+"\n    ")])],1),t._v(" "),e(v.a),t._v(" "),e(o.a,{staticClass:"mb-5 mt-3",attrs:{elevation:"0"}},[e(y.a,{staticClass:"rounded-md",attrs:{color:"background",dense:"",flat:"",dark:""}},[e(k.b,[e("span",[t._v(" Devices List")])]),t._v(" "),e(x.a,{attrs:{top:"",color:"primary"},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,c=n.attrs;return[e(r.a,t._g(t._b({staticClass:"ma-0 px-0",attrs:{dense:"","x-small":"",ripple:!1,text:""}},"v-btn",c,!1),o),[e(d.a,{staticClass:"ml-2",attrs:{color:"white",dark:""},on:{click:function(e){return t.getDataFromApi()}}},[t._v("mdi mdi-reload")])],1)]}}])},[t._v(" "),e("span",[t._v("Reload")])]),t._v(" "),e(x.a,{attrs:{top:"",color:"primary"},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,c=n.attrs;return[e(r.a,t._g(t._b({attrs:{"x-small":"",ripple:!1,text:""},on:{click:function(e){return t.toggleFilter()}}},"v-btn",c,!1),o),[e(d.a,{attrs:{dark:"",white:""}},[t._v("mdi-filter")])],1)]}}])},[t._v(" "),e("span",[t._v("Filter")])]),t._v(" "),e(m.a),t._v(" "),e(x.a,{attrs:{top:"",color:"primary"},scopedSlots:t._u([{key:"activator",fn:function(n){var o=n.on,c=n.attrs;return[e(r.a,t._g(t._b({attrs:{"x-small":"",ripple:!1,text:""},on:{click:t.updateDevicesHealth}},"v-btn",c,!1),o),[e(d.a,{attrs:{dark:"",white:""}},[t._v("mdi-cached")])],1)]}}])},[t._v(" "),e("span",[t._v("Sync Devices")])])],1),t._v(" "),e(_.a,{attrs:{timeout:3e3,color:t.snackColor},scopedSlots:t._u([{key:"action",fn:function(n){var o=n.attrs;return[e(r.a,t._b({attrs:{text:""},on:{click:function(e){t.snack=!1}}},"v-btn",o,!1),[t._v(" Close ")])]}}]),model:{value:t.snack,callback:function(e){t.snack=e},expression:"snack"}},[t._v("\n      "+t._s(t.snackText)+"\n\n      ")]),t._v(" "),e(l.a,{staticClass:"elevation-1",attrs:{dense:"",headers:t.headers_table,items:t.data,"model-value":"data.id",loading:t.loading,"footer-props":{itemsPerPageOptions:[50,100,500,1e3]},options:t.options,"server-items-length":t.totalRowsCount},on:{"update:options":function(e){t.options=e}},scopedSlots:t._u([{key:"header",fn:function(n){var r=n.props.headers;return[t.isFilter?e("tr",t._l(r,(function(header){return e("td",{key:header.text,staticStyle:{width:"50px"}},[header.filterable&&!header.filterSpecial?e(h.a,{attrs:{clearable:"","hide-details":!0,id:header.value,outlined:"",dense:"",autocomplete:"off"},on:{input:function(e){return t.applyFilters(header.key,e)}},model:{value:t.filters[header.value],callback:function(e){t.$set(t.filters,header.value,e)},expression:"filters[header.value]"}}):header.filterSpecial&&"Status"==header.text?e(f.a,{attrs:{"hide-details":!0,"item-value":"value","item-text":"title",outlined:"",dense:"",items:[{value:"",title:"All"},{value:"1",title:"Online"},{value:"2",title:"Offline"}]},on:{change:function(e){return t.applyFilters("status",e)}},model:{value:t.filters[header.text],callback:function(e){t.$set(t.filters,header.text,e)},expression:"filters[header.text]"}}):t._e()],1)})),0):t._e()]}},{key:"item.name",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(t.caps(n.name))+"\n      ")]}},{key:"item.short_name",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(t.caps(n.short_name))+"\n      ")]}},{key:"item.location",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(t.caps(n.location))+"\n      ")]}},{key:"item.device_id",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(n.device_id)+"\n      ")]}},{key:"item.device_type",fn:function(e){var n=e.item;return[t._v("\n        "+t._s(t.caps(n.device_type))+"\n      ")]}},{key:"item.status_id",fn:function(n){var r=n.item;return[e(c.a,{staticClass:"p-2 mx-1",attrs:{small:"",color:"active"==r.status.name?"primary":"error"}},[t._v("\n          "+t._s("active"==r.status.name?"online":"offline")+"\n        ")])]}},{key:"item.status",fn:function(n){var r=n.item;return[e(c.a,{staticClass:"p-2",attrs:{small:"",color:"primary"},on:{click:function(e){return t.open_door(r.device_id)}}},[t._v("\n          Open\n        ")]),t._v(" "),e(c.a,{staticClass:"p-2 mx-1",attrs:{small:"",color:"primary"},on:{click:function(e){return t.open_door_always(r.device_id)}}},[t._v("\n          Open Always\n        ")]),t._v(" "),e(c.a,{staticClass:"p-2",attrs:{small:"",color:"error"},on:{click:function(e){return t.open_door_always(r.device_id)}}},[t._v("\n          Close\n        ")])]}},{key:"item.sync_date_time",fn:function(n){var r=n.item;return[e(c.a,{staticClass:"p-2 mx-1",attrs:{small:"",color:"primary"},on:{click:function(e){return t.sync_date_time(r)}}},[t._v("\n          "+t._s("---"==r.sync_date_time?"click to sync":r.sync_date_time)+"\n        ")])]}}])})],1)],1)}),[],!1,null,null,null);e.default=component.exports},850:function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return c}));var r=n(95),o=n(0),c=Object(o.k)("v-toolbar__title"),l=Object(o.k)("v-toolbar__items");r.a}}]);